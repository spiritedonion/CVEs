# New Critical SQL Injection Vulnerability Discovered in Z-Push (CVE-2025-8264)

A newly identified critical vulnerability in **Z-Push** could expose sensitive data and lead to significant system compromise. This **SQL Injection** flaw, tracked as **CVE-2025-8264**, presents a severe risk of unauthorized access, data manipulation, or even complete loss of critical information for affected organizations. Proactive action is essential to protect your systems and data.

## Vulnerability Details

*   **CVE ID:** **CVE-2025-8264**
*   **Affected Software:** **Z-Push**, specifically versions of the `z-push/z-push-dev` package **prior to 2.7.6**.
*   **Technical Cause:** The vulnerability stems from **unparameterized queries** within the **IMAP backend** of Z-Push. When the `IMAP_FROM_SQL_QUERY` option is configured, an attacker can inject malicious SQL commands by manipulating the username field during basic authentication. This bypasses intended security controls and directly interacts with the database.
*   **Example Payload:** An attacker could craft a malicious string in the username field during basic authentication (e.g., `' OR 1=1--`), allowing arbitrary SQL commands to be executed on the linked database. This can be used to bypass authentication, extract, or manipulate data.

## Risk Description

Exploiting this **SQL Injection** vulnerability grants an attacker extensive control over a linked third-party database. This means they could:

*   **Steal sensitive data:** Access confidential user information, financial records, or other critical business data.
*   **Modify or delete data:** Corrupt or erase vital operational data, leading to severe disruption and data integrity issues.
*   **Achieve system compromise:** In certain configurations, SQL Injection can even lead to remote code execution, giving attackers full control over the server. The **CVSS Base Score of 9.1 (Critical)** underscores the extreme severity of this flaw.

## Who Is At Risk

Organizations running **Z-Push** installations are primarily at risk if they:

*   Utilize the **IMAP backend** for user authentication.
*   Have the `IMAP_FROM_SQL_QUERY` option explicitly configured within their `backend/imap/config.php` file.

## Recommendations

### For Developers

*   Ensure all database queries are **parameterized** to prevent SQL Injection vulnerabilities. Avoid concatenating user input directly into SQL strings.
*   Review all user input validation routines, especially for authentication mechanisms.

### For Website Owners/Admins

1.  **Immediate Update:** Upgrade your **Z-Push** installation to version **2.7.6** or later as soon as possible. This is the most effective way to address the vulnerability.
2.  **Configuration Mitigation (if immediate update isn't possible):**
    If upgrading immediately is not feasible, modify your `backend/imap/config.php` file. Change the `IMAP_DEFAULTFROM` setting to either an empty string or 'ldap' to disable the vulnerable query path:

    ```php
    define('IMAP_DEFAULTFROM', '');
    ```
    OR
    ```php
    define('IMAP_DEFAULTFROM', 'ldap');
    ```
    This mitigation should be considered temporary; a full upgrade remains the recommended long-term solution.

## Reference Link

For more detailed technical information and official advisories, please refer to:
[https://github.com/Z-Hub/Z-Push/blob/af25a2169a50d6e05a5916d1e8b2b6cd17011c98/src/backend/imap/user_identity.php%23L211C9-L214C25](https://github.com/Z-Hub/Z-Push/blob/af25a2169a50d6e05a5916d1e8b2b6cd17011c98/src/backend/imap/user_identity.php%23L211C9-L214C25)