## Critical XSS Vulnerability Discovered in Copyparty File Server (**CVE-2025-54589**)

We're alerting users to a newly identified security vulnerability in **Copyparty**, a popular portable file server. This critical flaw, tracked as **CVE-2025-54589**, could allow attackers to execute malicious scripts in your users' browsers, potentially leading to data theft, session hijacking, or broader system compromise. For any organization using **Copyparty** to share files, understanding and addressing this vulnerability is paramount to protecting sensitive information and maintaining operational integrity.

### Vulnerability Details

*   **CVE ID:** **CVE-2025-54589**
*   **Affected Software:** **Copyparty**
*   **Affected Versions:** All versions up to and including **1.18.6**
*   **Technical Cause:** The vulnerability is a reflected **Cross-Site Scripting (XSS)** flaw. When accessing the recent uploads page at `/?ru`, **Copyparty** allows users to filter results via an input field. The value entered into this filter field is appended to the URL as a parameter and then directly reflected into a `<script>` block on the page without proper security escaping. This allows an attacker to inject and execute arbitrary JavaScript code within the context of the user's browser session. The vulnerability can be exploited against both authenticated and unauthenticated users.
*   **Example Context:** An attacker could craft a malicious URL like `http://[your-copyparty-server]/?ru?filter=<script>alert('XSS')</script>`. If a user clicks this link, the injected script would run in their browser.

### Risk Description

An attacker who successfully exploits this **XSS** vulnerability could perform various malicious actions, including:

*   **Session Hijacking:** Steal session cookies, allowing them to impersonate the victim and gain unauthorized access to the victim's account on the **Copyparty** server.
*   **Data Theft:** Access and potentially exfiltrate sensitive data visible to the compromised user, such as filenames, user lists, or configuration details.
*   **Defacement/Redirection:** Alter the content of the web page or redirect users to malicious websites.
*   **Malware Injection:** Force the victim's browser to download and execute malware.
*   **Further Attacks:** Initiate requests to other internal systems from the victim's browser, potentially bypassing network access controls.

### Who is at Risk?

Organizations and individuals utilizing the **Copyparty** file server for internal or external file sharing are at risk. This includes anyone running **Copyparty** versions **1.18.6** or older on their systems. Given **Copyparty**'s role in file management, the potential for sensitive data exposure is significant.

### Recommendations

We strongly urge all users of **Copyparty** to take immediate action:

**For Website Owners and Administrators:**

*   **Update Immediately:** The most critical step is to update your **Copyparty** installation to version **1.18.7** or higher. This version contains the fix for **CVE-2025-54589**.
*   **Monitor Logs:** Regularly review server access logs for any unusual activity or suspicious requests to the `/?ru` path.
*   **Educate Users:** Advise your users to be cautious about clicking on unverified links, even those that appear to be from trusted sources.

**For Developers (if contributing to Copyparty or similar projects):**

*   **Input Validation and Output Encoding:** Always validate and sanitize user input on the server-side. Crucially, ensure all user-supplied data reflected in HTML, especially within `<script>` tags, is properly escaped (e.g., using context-aware encoding like JavaScript string escaping) to prevent script injection.
*   **Security Best Practices:** Adopt secure coding practices, including using security linters and conducting regular code reviews, to prevent similar vulnerabilities.

### Reference Link

For more detailed technical information and the official commit addressing this vulnerability, please refer to the following link:

[https://github.com/9001/copyparty/commit/a8705e611d05eeb22be5d3d7d9ab5c020fe54c62](https://github.com/9001/copyparty/commit/a8705e611d05eeb22be5d3d7d9ab5c020fe54c62)