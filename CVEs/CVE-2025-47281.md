Kyverno Policy Engine Denial of Service Vulnerability

Policy engines like Kyverno are critical components in cloud-native environments, enforcing security and operational policies across Kubernetes clusters. A vulnerability leading to their instability can severely disrupt operations, compromise the integrity of policy enforcement, and leave systems unprotected, making it crucial to address promptly.

A critical Denial of Service (DoS) vulnerability, identified as **CVE-2025-47281**, has been discovered in Kyverno. This affects **Kyverno versions 1.14.1 and below**.

The vulnerability stems from improper handling of **JMESPath variable substitutions**. An attacker with permissions to create or update Kyverno policies can craft a malicious expression. This expression, specifically using the `{{@}}` variable combined with a pipe (`|`) and an invalid JMESPath function (e.g., `{{@ | non_existent_function }}`), causes a `nil` value to be substituted into the policy structure.

Subsequent processing by internal Kyverno functions, particularly `getValueAsStringMap`, which expects string values, results in a panic due to a **type assertion failure** (`interface {} is nil, not string`).

This type assertion failure leads to a **Denial of Service (DoS)** condition. It crashes Kyverno worker threads within the admission controller and causes continuous crashes of the reports controller pod, severely disrupting policy enforcement and reporting capabilities within the cluster.

**Recommendations:**

Developers and site owners using Kyverno are strongly advised to **upgrade to version 1.14.2 or higher** immediately to mitigate this vulnerability.

**Reference:**
[https://github.com/kyverno/kyverno/commit/cbd7d4ca24de1c55396fc3295e9fc3215832be7c](https://github.com/kyverno/kyverno/commit/cbd7d4ca24de1c55396fc3295e9fc3215832be7c)