## Traffic-Induced Memory Leak in LibHTP

Memory leaks in critical network protocol parsers can significantly degrade the reliability and effectiveness of security monitoring systems. Such vulnerabilities can lead to system instability, service disruptions, and a critical loss of visibility into network traffic, potentially allowing malicious activity to go undetected.

### Vulnerability Details

A critical memory leak vulnerability, identified as **CVE-2025-53537**, has been discovered in **LibHTP**, a security-aware parser for the HTTP protocol. This issue affects **LibHTP** versions **0.5.50 and below**.

The vulnerability stems from a **traffic-induced memory leak**, specifically related to the LZMA decompression functionality within the parser. When processing certain HTTP traffic, **LibHTP** fails to properly release allocated memory, leading to a gradual consumption of system resources.

### Potential Risks

This memory leak can **starve the process of memory**, ultimately leading to a **denial of service (DoS)** for any application utilizing **LibHTP** (e.g., network intrusion detection systems like Suricata). For security monitoring tools, this translates to a **loss of visibility** into network traffic, allowing malicious activity or policy violations to potentially bypass detection and analysis, compromising overall security posture.

### Recommendations

**Upgrade Immediately:** Users are strongly advised to upgrade their **LibHTP** installation to version **0.5.51** or newer, where the issue is officially patched.

**Temporary Workaround:** For environments where an immediate upgrade is not feasible, a temporary workaround exists. Disable the LZMA decompression feature by setting the following configuration option in your `suricata.yaml` file:

```yaml
app-layer.protocols.http.libhtp.default-config.lzma-enabled: false
```

Note that this workaround may impact the ability to process HTTP traffic that utilizes LZMA compression.

### Reference

Further details and the commit that addresses this vulnerability can be found here:
[https://github.com/OISF/libhtp/commit/9037ea35110a0d97be5cedf8d31fb4cd9a38c7a7](https://github.com/OISF/libhtp/commit/9037ea35110a0d97be5cedf8d31fb4cd9a38c7a7)