### LibHTP Traffic-Induced Memory Leak Vulnerability

HTTP protocol parsers are fundamental components in network security monitoring and application analysis. A vulnerability within such a parser, particularly a memory leak, can have significant implications, ranging from degraded performance to a complete loss of visibility into network traffic, potentially allowing malicious activity to go undetected.

### Vulnerability Details

A critical memory leak vulnerability, identified as **CVE-2025-53537**, has been discovered in **LibHTP**, a security-aware parser for the HTTP protocol.

The issue specifically affects **LibHTP versions 0.5.50 and below**.

### Technical Cause

The vulnerability is a **traffic-induced memory leak**. This means that under certain traffic conditions, the LibHTP process progressively consumes more memory without releasing it, leading to eventual memory exhaustion. The provided workaround suggests that this issue is related to the **LZMA compression feature** within LibHTP's HTTP processing capabilities. When `lzma-enabled` is active, specific traffic patterns can trigger the leak.

### Potential Risks

The primary risk associated with this memory leak is **denial of service (DoS)**. As the process's memory is starved, the application utilizing LibHTP (e.g., an intrusion detection system like Suricata) may become unstable, crash, or cease processing traffic. This leads to a **loss of visibility**, severely impairing security monitoring and detection capabilities.

### Recommendations

**For Developers and Site Owners:**
*   **Upgrade Immediately:** The most effective mitigation is to upgrade LibHTP to **version 0.5.51** or higher, where the issue is officially patched.
*   **Apply Workaround (if immediate upgrade is not possible):** As a temporary measure, configure the application utilizing LibHTP to disable LZMA compression. For Suricata users, this can be done by setting the following in `suricata.yaml`:
    ```yaml
    app-layer:
      protocols:
        http:
          libhtp:
            default-config:
              lzma-enabled: false
    ```
    This workaround mitigates the specific traffic pattern causing the leak but may affect performance or functionality if LZMA compression is actively used for legitimate traffic.

### Reference

[https://github.com/OISF/libhtp/commit/9037ea35110a0d97be5cedf8d31fb4cd9a38c7a7](https://github.com/OISF/libhtp/commit/9037ea35110a0d97be5cedf8d31fb4cd9a38c7a7)