## Cross-Site Request Forgery Vulnerability in WordPress Omnishop Plugin

Web application vulnerabilities that enable unauthorized actions, such as Cross-Site Request Forgery (CSRF), pose significant risks to site integrity and user trust. When critical operations, like user account deletion, can be triggered without proper validation of user intent, it opens the door to malicious exploitation and potential service disruption.

### Vulnerability Details

A critical Cross-Site Request Forgery vulnerability, identified as **CVE-2025-6214**, has been discovered in the **Omnishop plugin for WordPress**. This vulnerability affects all versions of the plugin up to, and including, **1.0.9**.

The technical cause lies within the plugin's `/users/delete` REST route. While the route's `permission_callback` correctly verifies that the requester is logged in, it **fails to require any nonce or other proof of intent**. This absence of a security token allows unauthenticated attackers to craft a malicious request.

### Technical Cause

The `/users/delete` REST route's design flaw means that if an authenticated user, particularly a site administrator, is tricked into performing an action (e.g., clicking a specially crafted link in a phishing email), their browser will automatically include their authentication cookies with the forged request. Since no nonce is required to validate the user's explicit intent to perform the deletion, the server processes the request as legitimate.

### Potential Risks

This vulnerability enables attackers to perform **arbitrary user account deletion**. If a site administrator can be persuaded to click a malicious link, the attacker could delete any user account on the WordPress site, including other administrator accounts. This could lead to:

*   **Denial of Service (DoS)** by removing legitimate user access.
*   **Data integrity issues** through the deletion of user records.
*   **Compromise of site management** if administrator accounts are targeted.

### Recommendations

**For Site Owners:**
It is crucial to **immediately update the Omnishop plugin** to the latest available version once a patched release is published. Until then, exercise extreme caution regarding links from untrusted sources.

**For Developers:**
Implement robust **Cross-Site Request Forgery (CSRF) protection** for all sensitive actions, especially those exposed via REST API endpoints. This typically involves:
*   Using **nonces** (Number Used Once) or other token-based mechanisms to verify user intent for every state-changing request.
*   Ensuring `permission_callback` functions for REST routes are comprehensive, verifying not only authentication but also proper intent tokens.

### Reference Link

For further details and updates, please refer to:
[https://wordpress.org/plugins/omnishop/#developers](https://wordpress.org/plugins/omnishop/#developers)