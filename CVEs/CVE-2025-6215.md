## Unauthenticated Registration Bypass in Omnishop WordPress Plugin

Controlling user registration is a fundamental security measure for any website. When this control is bypassed, it can lead to unauthorized access, spam, and potentially open the door to further malicious activities. A recently identified vulnerability in the Omnishop WordPress plugin allows unauthenticated attackers to create new user accounts, circumventing intended site security policies.

### Vulnerability Details

A critical unauthenticated registration bypass vulnerability, identified as **CVE-2025-6215**, affects the **Omnishop plugin for WordPress**.

*   **Affected Software:** Omnishop plugin for WordPress
*   **Affected Versions:** All versions up to, and including, **1.0.9**.
*   **Technical Cause:** The plugin exposes a `/users/register` endpoint to the public. The `permission_callback` function for this endpoint is incorrectly configured to always return `true`, granting unconditional access. This endpoint then invokes the `wp_create_user()` function without verifying the site's **users_can_register** option, and critically, without implementing any **nonce** or **CAPTCHA** checks.
*   **Potential Risks:** This flaw enables unauthenticated attackers to create arbitrary user accounts, typically with the **customer** role, on affected websites. This bypasses the site owner's intent to close registrations and can lead to:
    *   Creation of spam accounts.
    *   Potential for resource exhaustion (e.g., database bloat).
    *   Abuse of features accessible to legitimate registered users.

### Recommendations

**For Site Owners:**

*   **Update Immediately:** Monitor the official WordPress plugin repository for a patched version of the Omnishop plugin and update to a version greater than **1.0.9** as soon as it becomes available.
*   **Deactivation/Removal:** If an immediate patch is not available, consider deactivating or removing the Omnishop plugin until a secure version is released.
*   **User Account Review:** Periodically review existing user accounts for any unauthorized or suspicious registrations that may have occurred.

**For Developers:**

*   **Strict Access Control:** Ensure all sensitive endpoints, especially those involving user creation or modification, have robust access control mechanisms.
*   **Respect Core Settings:** Always check and respect WordPress core settings, such as `users_can_register`, before performing actions that can be controlled by them.
*   **Security Mechanisms:** Implement nonces for form submissions and critical actions, and integrate CAPTCHA or similar bot-prevention solutions for registration forms to prevent automated abuse.
*   **Proper Permissions:** Thoroughly review `permission_callback` functions to ensure they accurately enforce the intended access policies.

### Reference

For further details and updates, refer to the official Omnishop plugin page:

[Omnishop Plugin Page](https://wordpress.org/plugins/omnishop/#developers)