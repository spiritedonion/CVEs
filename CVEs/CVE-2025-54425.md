## New Vulnerability Discovered in Umbraco CMS: API Key Bypass via Caching Issue

A critical vulnerability has been identified in **Umbraco CMS** that could allow unauthorized access to sensitive content on websites. This flaw, if exploited, could expose confidential data or proprietary information, leading to significant reputational damage and potential regulatory penalties for affected organizations.

### Vulnerability Details

*   **CVE ID:** **CVE-2025-54425**
*   **Affected Software:** **Umbraco CMS**
*   **Affected Versions:** Versions **13.0.0** through **13.9.2**, **15.0.0** through **15.4.1**, and **16.0.0** through **16.1.0** are vulnerable. The issue has been fixed in versions **13.9.3**, **15.4.4**, and **16.1.1** or later.
*   **Technical Cause:** The vulnerability stems from an issue within Umbraco's Content Delivery API when it is configured with both API key restrictions and output caching. While the API key is designed to limit access to sensitive content, the caching mechanism does not properly differentiate requests based on the presence or validity of this key. This means if a legitimate user accesses content using a valid API key, the response is cached. Subsequently, an attacker without a valid key can request the same content and receive the cached response, effectively bypassing the intended security control.

**Example Scenario:**
Imagine your Umbraco Content Delivery API is set up to protect sensitive documents at a path like `/umbraco/api/v1/content/private-documents`.

1.  A legitimate user makes a request with a valid API key (e.g., in a header) for:
    `GET /umbraco/api/v1/content/private-documents`
    The system returns the private document content, and this response is then cached.

2.  An attacker then makes the exact same request *without* a valid API key:
    `GET /umbraco/api/v1/content/private-documents`
    Instead of being denied access, the attacker is served the cached response containing the private documents, as the caching mechanism does not re-validate the API key for subsequent requests to the cached item.

### Risk Description

An attacker could **bypass API key authentication** to gain unauthorized access to any content delivered through the Umbraco Content Delivery API that has been restricted by an API key and subsequently cached by a legitimate request. This could lead to the **disclosure of sensitive information**, including proprietary business data, confidential user details, or internal operational documents, depending on the content exposed via the API.

### Who is at Risk

Organizations and website owners using **Umbraco CMS** are at risk if their installations fall within the affected version ranges and they utilize the **Content Delivery API with both API key authentication and output caching enabled**. This specifically impacts sites that rely on the API key as the primary mechanism to restrict access to certain content.

### Recommendations

**For Website Owners and Administrators:**

*   **Immediate Update:** The most critical action is to **update your Umbraco CMS** installation to a patched version immediately. The fixed versions are **13.9.3**, **15.4.4**, and **16.1.1** or later.
*   **Review API Configuration:** If immediate updating is not feasible, consider temporarily disabling output caching for your Content Delivery API endpoints, especially those secured with API keys, until you can update. This may impact performance but will mitigate the immediate risk.

**For Developers:**

*   **Update Dependencies:** Ensure your Umbraco projects target the patched versions mentioned above.
*   **Cache Strategy Review:** Understand that caching implementations must properly "vary by" all relevant request components (like authentication headers or query parameters) to prevent information leakage. Umbraco's fix addresses this specific missing vary-by header.

### Reference Link

For more detailed information and official advisories regarding this vulnerability, please refer to the Umbraco documentation: [https://docs.umbraco.com/umbraco-cms/reference/content-delivery-api](https://docs.umbraco.com/umbraco-cms/reference/content-delivery-api)