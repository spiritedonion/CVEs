## Harbor Cross-Site Scripting Vulnerability

Cloud-native registries like Harbor are critical components in the software supply chain, storing and managing container images and artifacts. A Cross-Site Scripting (XSS) vulnerability in such a system can pose significant risks, allowing attackers to compromise user sessions, steal credentials, or manipulate the interface, potentially leading to broader system compromises within the development or deployment environments.

### Vulnerability Details

A critical **Cross-Site Scripting (XSS)** vulnerability, identified as **CVE-2025-32019**, has been discovered in **Harbor**, the open-source trusted cloud-native registry project.

The vulnerability affects **Harbor versions 2.11.2 and below**, as well as **2.12.0-rc1** and **2.13.0-rc1**.

The technical cause stems from inadequate input handling within the **markdown field** on the **info tab page**. This allows an attacker to inject malicious JavaScript code. When a legitimate user views a page containing this manipulated markdown, the injected script executes within their browser's security context due to insufficient sanitization or encoding of the user-supplied content.

### Potential Risks

Successful exploitation of this XSS vulnerability could enable an attacker to:

*   **Hijack user sessions**, including administrator sessions, gaining unauthorized access.
*   **Steal sensitive information** such as authentication tokens or credentials directly from the user's browser.
*   **Deface the Harbor interface** or present misleading information to users.
*   **Redirect users to malicious websites** for phishing or further attacks.
*   Execute arbitrary actions within the victim's browser session, potentially leading to **unauthorized actions** within the registry or further attacks against the underlying infrastructure.

### Recommendations

For **Harbor administrators and site owners**:

*   **Immediate Upgrade:** All vulnerable Harbor instances should be upgraded to a patched version without delay. The vulnerability is fixed in **Harbor versions 2.11.3** and **2.12.3**.

For **developers working with markdown rendering or user-supplied content**:

*   Implement strict **input sanitization** to filter out malicious characters and script tags from user-provided data.
*   Ensure all user-supplied content is properly **output encoded** before being rendered in a web browser, especially when dealing with formats like markdown.
*   Consider implementing a robust **Content Security Policy (CSP)** to mitigate the impact of potential XSS vulnerabilities by restricting the sources of executable scripts.

### Reference

[Harbor Commit for CVE-2025-32019](https://github.com/goharbor/harbor/commit/76c2c5f7cfd9edb356cbb373889a59cc3217a058)