Anubis Web AI Firewall Redirect/XSS Vulnerability (CVE-2025-54414)

Web AI firewalls like Anubis are critical components in protecting online resources from automated threats and malicious bots. A vulnerability within such a security utility can undermine its core purpose, potentially exposing users to client-side attacks or allowing redirects to malicious sites, compromising data integrity and user trust.

### Vulnerability Details

A critical vulnerability, tracked as **CVE-2025-54414**, has been identified in the **Anubis Web AI Firewall Utility**.

*   **Affected Software:** Anubis Web AI Firewall Utility
*   **Affected Versions:** All versions **1.21.2 and below** are vulnerable.
*   **Technical Cause:** The vulnerability stems from insufficient validation of the `redir` parameter used within the pass-challenge mechanism. Attackers can craft malicious `pass-challenge` pages that, when presented to a user, cause their browser to execute arbitrary JavaScript code or trigger other nonstandard URI schemes. Specifically, the `/.within.website/x/cmd/anubis/api/pass-challenge` route, when supplied with an improperly validated `?redir=` parameter, allows for this exploit. An incomplete fix was tagged at version 1.21.2, but the issue remained, necessitating a further correction.

### Potential Risks

Exploitation of this vulnerability can lead to several severe outcomes:

*   **Client-Side Arbitrary JavaScript Execution (Cross-Site Scripting - XSS):** Attackers can inject and execute malicious scripts in the user's browser, potentially leading to session hijacking, credential theft, unauthorized actions, or defacement of the legitimate page.
*   **Open Redirect:** Users can be unknowingly redirected to malicious phishing sites or other undesirable destinations, enabling further social engineering attacks or malware distribution.

### Recommendations

Site owners and developers using Anubis Web AI Firewall Utility should take immediate action:

1.  **Upgrade Immediately:** The primary recommendation is to **immediately upgrade** to **Anubis Web AI Firewall Utility version 1.21.3** or later, where this vulnerability has been fully addressed.
2.  **Temporary Workaround:** If an immediate upgrade is not feasible, implement a security rule (e.g., via a Web Application Firewall or server configuration) to **block any requests** to the `/.within.website/x/cmd/anubis/api/pass-challenge` route where the `?redir=` parameter does not start with `http://`, `https://`, or represent a valid local path.

### Reference

For further details and updates, refer to the official fix:
[https://github.com/TecharoHQ/anubis/pull/904](https://github.com/TecharoHQ/anubis/pull/904)