## Privilege Escalation Vulnerability in Realty Portal – Agent WordPress Plugin

Privilege escalation vulnerabilities are critical as they allow attackers with lower-level access to gain elevated permissions, often leading to full compromise of a web application. This write-up details such a vulnerability found in the Realty Portal – Agent plugin for WordPress, enabling standard users to attain administrative control.

### Vulnerability Details

A critical **privilege escalation** vulnerability, tracked as **CVE-2025-6190**, has been identified in the **Realty Portal – Agent** plugin for WordPress. This flaw affects plugin versions **0.1.0 through 0.3.9**.

The vulnerability resides within the `rp_user_profile()` **AJAX handler**. This handler is designed to update user profile metadata but lacks proper authorization checks. Specifically, it directly reads client-supplied meta key and value pairs from the `$_POST` array and passes them without validation or whitelisting to the `update_user_meta()` function.

This design flaw allows **authenticated attackers** with **Subscriber-level access** or higher to manipulate their user metadata. By sending a malicious request, an attacker can overwrite the `wp_capabilities` user meta key, effectively granting themselves the **Administrator role**.

### Potential Risks

Successful exploitation of this vulnerability grants attackers full administrative control over the WordPress site. This can lead to:

*   **Complete site compromise**: Attackers can install malicious plugins or themes, upload backdoors, or modify site content.
*   **Remote Code Execution (RCE)**: With administrator access, attackers can often achieve RCE through various means (e.g., plugin/theme editor, arbitrary file uploads).
*   **Data Exposure/Manipulation**: Access to the database allows for viewing, modifying, or exfiltrating sensitive user or site data.
*   **Website Defacement**: Attackers can alter the website's appearance or content.
*   **Further Attack Propagation**: The compromised site can be used as a platform for launching attacks against other systems or users.

### Recommendations

*   **Immediate Update**: Site owners using the **Realty Portal – Agent** plugin should immediately update to a patched version once available. If no patched version exists, consider deactivating and removing the plugin until a fix is released.
*   **Developer Action**: Developers of the plugin must implement robust authorization checks within the `rp_user_profile()` AJAX handler. This includes validating and whitelisting all meta keys that can be updated, ensuring only legitimate and authorized changes are permitted for specific user roles.
*   **Principle of Least Privilege**: Ensure all users operate with the minimum necessary permissions. Regularly review user roles and capabilities across your WordPress installation.

### Reference

For a technical insight into the vulnerable code, refer to the following:
[https://plugins.trac.wordpress.org/browser/realty-portal-agent/trunk/includes/class-agent-process.php#L494](https://plugins.trac.wordpress.org/browser/realty-portal-agent/trunk/includes/class-agent-process.php#L494)