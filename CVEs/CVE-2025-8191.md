### Cross-Site Scripting Vulnerability in macrozheng mall

A critical **Cross-Site Scripting (XSS)** vulnerability has been identified in the `macrozheng mall` application. This type of vulnerability can allow attackers to inject malicious scripts into web pages viewed by other users, potentially leading to session hijacking, data theft, or defacement. Given the public disclosure of an exploit, immediate attention to this issue is advised for affected deployments.

#### Vulnerability Details

*   **CVE ID:** `CVE-2025-8191`
*   **Affected Product:** `macrozheng mall`
*   **Affected Versions:** All versions up to `1.0.3`
*   **Vulnerability Type:** **Cross-Site Scripting (XSS)**

The vulnerability resides within the `/swagger-ui/index.html` file, specifically within the **Swagger UI** component. It stems from insufficient sanitization of the `configUrl` argument. An attacker can manipulate this argument to inject arbitrary client-side scripts, which are then executed in the context of the user's browser when they access the affected URL.

This vulnerability is remotely exploitable, and an exploit has been publicly disclosed. Efforts to contact the vendor regarding this issue have been unsuccessful, with the original GitHub issue being deleted and no response received via email.

#### Potential Risks

Successful exploitation of this XSS vulnerability can lead to several severe consequences:

*   **Session Hijacking:** Attackers can steal session cookies, gaining unauthorized access to a user's account.
*   **Arbitrary Script Execution:** Malicious scripts can be executed in the user's browser context, allowing attackers to deface the website, redirect users to malicious sites, or perform actions on behalf of the user.
*   **Sensitive Data Exposure:** Scripts could potentially exfiltrate sensitive user data accessible within the browser.
*   **Malware Distribution:** Attackers could redirect users or inject scripts that attempt to download malware.

#### Recommendations

*   **Input Validation and Output Encoding:** Implement robust input validation for all user-supplied data, especially URL parameters like `configUrl`. All output reflecting user input should be properly encoded to prevent script execution.
*   **Update Software:** Monitor for official patches or new versions of `macrozheng mall` that address this vulnerability and update immediately once available.
*   **Content Security Policy (CSP):** Implement a strict Content Security Policy (CSP) to mitigate XSS risks by controlling which resources the browser is allowed to load.
*   **Restrict Access:** If the Swagger UI interface is not essential for public access, consider restricting access to trusted IP addresses or disabling it in production environments.

#### Reference

[https://github.com/macrozheng/mall/issues/919](https://github.com/macrozheng/mall/issues/919)