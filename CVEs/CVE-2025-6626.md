## Critical Security Alert: Stored XSS Vulnerability in ShortPixel Adaptive Images Plugin (CVE-2025-6626)

We are issuing an urgent advisory regarding a newly discovered security vulnerability in the **ShortPixel Adaptive Images – WebP, AVIF, CDN, Image Optimization** plugin for WordPress. This critical flaw, identified as a Stored Cross-Site Scripting (XSS) vulnerability, poses a significant risk to affected websites, potentially leading to website compromise, data manipulation, or even the redirection of site visitors to malicious content.

For businesses and organizations relying on WordPress, particularly those with multi-site installations, this vulnerability could compromise user trust, lead to financial losses due to reputational damage, or result in regulatory non-compliance if sensitive data is exposed. Prompt action is crucial to mitigate these risks.

### Vulnerability Details

*   **CVE ID:** **CVE-2025-6626**
*   **Affected Software:** The **ShortPixel Adaptive Images – WebP, AVIF, CDN, Image Optimization** plugin for WordPress.
*   **Affected Versions:** All versions up to, and including, **3.10.3**.
*   **Technical Cause:** The vulnerability stems from insufficient input sanitization and output escaping within the plugin's `API URL Setting`. This allows an attacker to inject malicious web scripts into the database, which are then permanently stored.
*   **Exploitation:** An authenticated attacker with administrator-level access can inject arbitrary web scripts. These scripts will execute in the browser of any user who accesses a page where the injected script is displayed. This is particularly concerning as it affects multi-site installations and environments where the `unfiltered_html` capability has been disabled for administrators, meaning even privileged users are not inherently protected from this specific injection vector.

### Risk Description

If exploited, this Stored Cross-Site Scripting vulnerability allows an attacker to:

*   **Steal Sensitive Information:** Capture user session cookies, potentially leading to account takeovers.
*   **Deface Websites:** Alter the appearance or content of affected web pages.
*   **Redirect Users:** Force visitors to malicious websites without their knowledge.
*   **Inject Malicious Content:** Insert phishing forms or malware download links.
*   **Perform Actions as Legitimate Users:** Execute actions within the site on behalf of a compromised user, potentially leading to further compromise.

While administrator access is required for the initial script injection, the impact extends to any user viewing an affected page, making this a serious persistent threat.

### Who is at Risk?

Your WordPress site is at risk if you are running:

*   The **ShortPixel Adaptive Images – WebP, AVIF, CDN, Image Optimization** plugin version **3.10.3** or earlier.
*   Specifically, this vulnerability significantly impacts **WordPress multi-site installations** or single-site installations where the `unfiltered_html` capability has been disabled for administrators.

### Recommendations

**For Website Owners and Administrators:**

*   **Update Immediately:** The most critical action is to update your **ShortPixel Adaptive Images – WebP, AVIF, CDN, Image Optimization** plugin to version **3.10.4** or newer without delay. This version includes the necessary security fixes.
    *   Log into your WordPress admin dashboard.
    *   Navigate to "Plugins" > "Installed Plugins."
    *   Locate "ShortPixel Adaptive Images" and click "Update Now" if an update is available.
    *   If no automatic update is shown, consider deactivating and deleting the old version (after a full backup) and then installing the latest version from the WordPress plugin directory.
*   **Regular Backups:** Ensure you have recent, tested backups of your website and database.
*   **Principle of Least Privilege:** Always follow the principle of least privilege for user accounts, even for administrators.

**For Developers (Plugin Maintainers):**

*   **Robust Input Validation:** Implement stringent input validation for all user-supplied data, especially in configuration settings like the `API URL Setting`.
*   **Contextual Output Escaping:** Ensure all output is properly escaped based on the context (e.g., HTML, attribute, JavaScript) to prevent script execution. This is crucial even for data entered by administrators, especially given the nuances of `unfiltered_html` in WordPress.

### Reference Link

For more detailed technical information and the official advisory from the plugin's development team, please refer to:

[https://plugins.trac.wordpress.org/browser/shortpixel-adaptive-images/tags/3.10.4/includes/front/vanilla-js-loader.class.php#L48](https://plugins.trac.wordpress.org/browser/shortpixel-adaptive-images/tags/3.10.4/includes/front/vanilla-js-loader.class.php#L48)

Acting quickly to apply this update will protect your website and its users from potential compromise.