## Lakeside Software SysTrack Local Privilege Escalation via DLL Hijacking

Privilege escalation vulnerabilities are critical as they allow a low-privileged attacker to gain full control over a system, circumventing security boundaries. Such an exploit can lead to complete system compromise, data exfiltration, or the deployment of further malicious payloads.

### Vulnerability Details

A critical local privilege escalation vulnerability (CVE-2025-6241) has been identified in Lakeside Software's SysTrack product.

*   **CVE ID:** `CVE-2025-6241`
*   **Affected Software:** Lakeside Software SysTrack
*   **Affected Component:** The `LsiAgent.exe` executable, a core component of SysTrack.
*   **Technical Cause:** The `LsiAgent.exe` process attempts to load several Dynamic Link Library (DLL) files that are not present in the default SysTrack installation. Due to the Windows default dynamic-link library search order, the system searches for these missing DLLs in directories listed within the `SYSTEM PATH` environment variable. If a directory within the `SYSTEM PATH` is **user-writable**, a low-privileged user can place a malicious DLL with one of the expected filenames into that directory.

Upon service start or restart of `LsiAgent.exe`, the legitimate process will load and execute the malicious DLL.

*   **Execution Context:** The malicious DLL is executed in the context of `NT AUTHORITY\SYSTEM`, the highest privilege level on a Windows system.

### Potential Risks

This vulnerability allows for **local privilege escalation (LPE)**. An attacker who has local access to a system running SysTrack can:

*   Execute arbitrary code with `NT AUTHORITY\SYSTEM` privileges.
*   Completely compromise the affected system.
*   Install persistent backdoors or rootkits.
*   Disable security software or manipulate system configurations.
*   Access or exfiltrate sensitive data.

### Recommendations

**For System Administrators and Site Owners:**

*   **Patching:** Immediately apply any available patches or hotfixes from Lakeside Software for SysTrack. Refer to the provided reference link for release notes and updates.
*   **Review SYSTEM PATH:** Audit the `SYSTEM PATH` environment variable on all systems running SysTrack. Identify and remove any user-writable directories from this critical system variable. This reduces the attack surface for DLL hijacking.
*   **Principle of Least Privilege:** Ensure that user accounts do not have write permissions to system-critical directories or directories included in the `SYSTEM PATH`.

**For Developers (General Best Practice):**

*   **Secure DLL Loading:** Always specify the full path to DLLs when loading them, especially for services or applications running with elevated privileges. Avoid relying on the default DLL search order.
    *   Utilize functions like `LoadLibraryEx` with flags such as `LOAD_LIBRARY_SEARCH_DLL_LOAD_DIR` or `LOAD_LIBRARY_SEARCH_DEFAULT_DIRS` to explicitly control the search path and prevent unexpected DLL loading from insecure locations.
*   **Comprehensive Packaging:** Ensure all necessary DLLs are included with the application's installation or are installed in secure, non-writable locations (e.g., `Program Files`).
*   **Dependency Auditing:** Regularly audit application dependencies to identify and address any missing or insecurely loaded components.

### Reference

[Lakeside Software SysTrack Agent Release Notes (Agent 10.10.0 Hotfix)](https://documentation.lakesidesoftware.com/en/Content/Release%20Notes/Agent/10_10_0%20Hotfix%20Agent%20Release%20Notes%20On%20Premises.htm?tocpath=Release%20Notes%7CAgent%7C_____13)