## Critical XSS Vulnerability Discovered in **MapTiler Tileserver-php** (CVE-2025-44136)

A significant security vulnerability has been identified in **MapTiler Tileserver-php**, posing a risk to organizations and individuals using this software. This Cross-Site Scripting (XSS) flaw could allow attackers to execute malicious code within a user's browser, potentially leading to data breaches, unauthorized access, and damage to reputation. Understanding and addressing this vulnerability is critical for maintaining the security and integrity of your web applications.

### Vulnerability Details

*   **CVE ID:** **CVE-2025-44136**
*   **Affected Software:** **MapTiler Tileserver-php**
*   **Affected Version:** v2.0

The vulnerability stems from improper handling of the "layer" GET parameter within **MapTiler Tileserver-php** v2.0. When an error occurs, the content of this parameter is reflected directly in the error message without proper HTML encoding. This oversight allows an unauthenticated attacker to inject and execute arbitrary HTML or JavaScript code within a victim's web browser.

**Example of a potential malicious request:**
`https://your-tileserver-domain.com/path/to/tileserver.php?layer=<script>alert('XSS_Vulnerable');</script>`

### Risk Description

If exploited, this Cross-Site Scripting (XSS) vulnerability could enable an unauthenticated attacker to:

*   **Steal Sensitive Data:** Capture session cookies, authentication tokens, or other sensitive information displayed on the page. This could grant the attacker unauthorized access to user accounts or administrative interfaces.
*   **Deface Websites:** Modify the content or appearance of the affected web page.
*   **Redirect Users:** Force users to malicious websites (e.g., phishing sites) or download malware.
*   **Execute Arbitrary Actions:** Perform actions on behalf of the victim, potentially leading to unauthorized data modification or deletion, depending on the victim's privileges.

### Who is at Risk?

Any organization or individual currently using **MapTiler Tileserver-php** version **2.0** is immediately at risk. This includes websites and applications that integrate or rely on this specific version of the software for serving map tiles. It is imperative to identify if your systems utilize this software to assess your exposure.

### Recommendations

**For Developers:**

*   **Implement Robust Input Validation:** Always validate and sanitize all user-supplied input, especially for parameters like `layer` that might be reflected in error messages or page output.
*   **Output Encoding:** Ensure that all output generated by the application is properly HTML-encoded before being rendered in the browser. This prevents the browser from interpreting malicious input as executable code.
*   **Security by Design:** Prioritize security in all stages of development, including code reviews and security testing.

**For Website Owners/Admins:**

*   **Urgent Update:** The most critical step is to update your **MapTiler Tileserver-php** installation to the latest secure version immediately once it becomes available. Regularly check the official MapTiler repository for security patches and updates.
*   **Monitor Logs:** Implement vigilant monitoring of your web server and application logs for suspicious activity, particularly requests targeting the `layer` parameter with unusual characters or scripts.
*   **Web Application Firewall (WAF):** Consider deploying a Web Application Firewall (WAF) to help detect and block common XSS attack patterns, providing an additional layer of defense.

### Reference Link

For more detailed technical information and official advisories, please refer to the following link:
[https://github.com/maptiler/tileserver-php/issues/167](https://github.com/maptiler/tileserver-php/issues/167)