### Unauthenticated SQL Injection in GeoDirectory WordPress Plugin (CVE-2024-13507)

SQL injection vulnerabilities pose a significant threat to web applications, potentially leading to the unauthorized disclosure or manipulation of sensitive data. When such vulnerabilities are exploitable by **unauthenticated** attackers, the risk escalates, allowing broader access to a system's database without requiring any prior authentication.

A **time-based SQL Injection** vulnerability, identified as **CVE-2024-13507**, has been discovered in the **GeoDirectory â€“ WP Business Directory Plugin and Classified Listings Directory** for WordPress. This critical flaw affects all plugin versions up to and including **2.8.97**. The vulnerability was published on 2025-07-26.

The vulnerability stems from **insufficient escaping** of user-supplied input and a lack of proper **prepared statements** on the existing SQL queries. Specifically, the **`dist` parameter** is susceptible to injection.

**Technical Cause:**
The plugin fails to properly sanitize or escape data passed through the `dist` parameter before incorporating it into a database query. This oversight, combined with the absence of robust parameterized queries, allows an attacker to append arbitrary SQL commands to the original query. The time-based nature implies an attacker can infer information by observing delays in database responses.

The affected code can be observed around line 733 in the file:
`includes/class-geodir-query.php`

**Potential Risks:**
This vulnerability allows **unauthenticated attackers** to execute additional SQL queries within the database. The primary risk is the **extraction of sensitive information**, which could include user credentials, personal data, proprietary business information, or other critical data stored within the WordPress database. Such data exposure can lead to severe privacy breaches, financial loss, or further system compromise.

**Recommendations:**
*   **Update Immediately:** Site owners using the GeoDirectory plugin should update to the latest available version that addresses **CVE-2024-13507** as soon as a patch is released (i.e., a version higher than 2.8.97).
*   **Input Validation:** Developers should implement strict **input validation** and **sanitization** for all user-supplied data.
*   **Parameterized Queries:** Always use **prepared statements** or parameterized queries when interacting with databases to prevent SQL injection by separating code from data.
*   **Regular Updates:** Ensure all WordPress core, themes, and plugins are kept up-to-date to receive security patches promptly.

**Reference:**
[https://plugins.trac.wordpress.org/browser/geodirectory/tags/2.8.97/includes/class-geodir-query.php#L733](https://plugins.trac.wordpress.org/browser/geodirectory/tags/2.8.97/includes/class-geodir-query.php#L733)