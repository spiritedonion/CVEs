## Critical SQL Injection Vulnerability Discovered in Piwigo (CVE-2024-43018)

A new, critical security vulnerability has been identified in Piwigo, a popular photo gallery software. This flaw, if exploited, could lead to unauthorized access to sensitive data, database manipulation, or even full system compromise. For organizations and individuals alike, this translates to significant risks including data breaches, reputational damage, and potential regulatory penalties.

### Vulnerability Details

*   **CVE ID:** **CVE-2024-43018**
*   **Affected Software:** **Piwigo**
*   **Affected Versions:** **13.8.0 and below**

The vulnerability is an **SQL Injection** flaw present in the `max_level` and `min_register` parameters. These parameters are used by the `ws_user_gerList` function, located in the file `include\ws_functions\pwg.users.php`. This function, accessible through `ws.php`, can be exploited when searching for users in an advanced way, specifically via the `admin.php?page=user_list` administration interface.

In essence, an attacker can inject malicious code into data inputs when interacting with these parameters, tricking the Piwigo database into executing unauthorized commands.

**Affected parameters:** `max_level`, `min_register`
**Affected files/paths:** `include\ws_functions\pwg.users.php`, `ws.php`, `/admin.php?page=user_list`

### Risk Description

An attacker successfully exploiting this **SQL Injection** vulnerability could gain unauthorized access to your Piwigo database. This could allow them to view, modify, or delete critical data, including user information, gallery details, or potentially even administrative credentials.

In severe cases, **SQL Injection** can lead to complete database compromise. This might enable an attacker to execute arbitrary commands on the underlying server, install malware, or take full control of the affected system, leading to a significant security incident.

### Who is at Risk?

Any organization or individual running a Piwigo installation with version **13.8.0 or older** is at risk. This includes websites, personal galleries, or internal photo management systems that rely on the Piwigo software. It's crucial for administrators to understand their exposure.

### Recommendations

**For Piwigo Users and Administrators:**

*   **Update Immediately:** The most critical action is to **immediately update your Piwigo installation** to the latest available version. Check the official Piwigo website for patch releases that address this vulnerability.
*   **Backup Regularly:** Ensure you have recent, verified backups of your Piwigo database and files. This is a critical step in any disaster recovery plan.
*   **Monitor Activity:** Keep a close eye on your Piwigo installation logs for any suspicious activity or unusual database queries.

**For Developers (especially Piwigo core developers):**

*   **Input Validation:** Ensure all user inputs are rigorously sanitized and validated before being used in database queries. Implement strict type checking and whitelist validation where possible.
*   **Parameterized Queries:** Always use parameterized queries or prepared statements when interacting with databases. This practice separates code from data, effectively preventing SQL Injection vulnerabilities.
*   **Secure Coding Practices:** Follow secure coding guidelines and conduct regular security audits and penetration testing to identify and remediate vulnerabilities proactively.

### Reference Link

For more technical details and official updates, please refer to the following:
[https://github.com/Piwigo/Piwigo/issues/2197](https://github.com/Piwigo/Piwigo/issues/2197)