### SQL Injection Vulnerability in XWiki Platform (CVE-2025-54385)

SQL Injection vulnerabilities represent a **critical** security risk, allowing attackers to manipulate database queries and potentially gain unauthorized access to sensitive data or execute arbitrary commands on the underlying system. This write-up details a significant **SQL Injection** flaw discovered in the **XWiki Platform**.

---

**Vulnerability Details:**

*   **CVE ID:** `CVE-2025-54385`
*   **CVSS Score:** `CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X`
*   **Base Score:** **8.6 (High)**
*   **Published:** 2025-07-26

---

**Affected Software:**

The vulnerability impacts **XWiki Platform** versions configured with an Oracle database:

*   All versions from `17.0.0-rc1` up to and including `17.2.2`.
*   All versions `16.10.5` and below.

---

**Technical Explanation:**

The **XWiki Platform** is susceptible to **SQL Injection** due to insufficient input sanitization within its `XWiki#searchDocuments` APIs. These APIs are designed to handle document search queries but directly pass unsanitized input to the underlying **Hibernate** Object-Relational Mapping (ORM) framework.

Even when these APIs attempt to enforce a specific `SELECT` clause, attackers can leverage **Hibernate Query Language (HQL)** native function support. By injecting malicious code into other query parts, such as the `WHERE` clause, an attacker can execute arbitrary SQL queries. Specific attack vectors noted involve using Oracle database functions like `DBMS_XMLGEN` or `DBMS_XMLQUERY` to facilitate the exploitation. Exploitation of this vulnerability requires **high privileges** (`PR:H`) within the XWiki environment.

---

**Potential Risks:**

Successful exploitation of this **SQL Injection** vulnerability can lead to severe consequences, including:

*   **Sensitive Data Exposure:** Attackers can exfiltrate confidential information directly from the database.
*   **Data Manipulation:** Unauthorized modification, insertion, or deletion of data within the database.
*   **Remote Code Execution (RCE):** In certain configurations, particularly when interacting with powerful database functions (e.g., Oracle's `DBMS_XMLGEN`), an attacker may be able to achieve **remote code execution** on the server hosting the database.
*   **Complete System Compromise:** Compromise of the database server and potentially the entire application.

---

**Recommendations:**

Developers and site owners using **XWiki Platform** are urged to **patch immediately** to the latest secure versions to mitigate this risk:

*   For users on the `16.x` branch, upgrade to **XWiki Platform `16.10.6`** or a later release.
*   For users on the `17.x` branch, upgrade to **XWiki Platform `17.3.0-rc-1`** or a later release.

Regular security audits, stringent input validation, and adherence to secure coding practices are essential to prevent similar vulnerabilities in the future.

---

**Reference:**

[Oracle DBMS_XMLGEN Documentation](https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_XMLGEN.html)