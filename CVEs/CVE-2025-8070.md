## Unquoted Service Path Vulnerability in ABP and AES

Unquoted service paths represent a significant local privilege escalation vulnerability in Windows environments. This issue allows a local attacker to execute arbitrary code with elevated privileges, highlighting the importance of proper service configuration.

### Vulnerability Details

A critical vulnerability, tracked as **CVE-2025-8070**, has been identified in the Windows service configurations of **ABP** and **AES**. The vulnerability specifically arises from an **unquoted ImagePath registry value**.

*   **Affected Products and Versions:**
    *   **ABP** version `2.0.7.6130` and earlier
    *   **AES** version `1.0.6.6133` and earlier

### Technical Cause

Windows services configured with an **unquoted ImagePath** registry value are susceptible to this flaw if their executable path contains spaces. For example, a service executable located at `C:\Program Files\Application\service.exe` might have its `ImagePath` registered simply as `C:\Program Files\Application\service.exe` instead of `"C:\Program Files\Application\service.exe"`.

When Windows attempts to execute such an unquoted path, it interprets the first space as a delimiter. In the example above, it would attempt to execute `C:\Program.exe`. A local attacker can exploit this by placing a malicious executable named `Program.exe` in a predictable location such as `C:\`. When the legitimate service attempts to start, the malicious executable will be executed instead.

### Potential Risks

This vulnerability allows for **local arbitrary code execution**. If the affected service runs with elevated privileges—which is common for many system services—successful exploitation can lead to **privilege escalation** to **SYSTEM** level. This grants the attacker full control over the compromised system.

The vulnerability has a CVSS Base Score of `9.2 CRITICAL`, with the following vector: `CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:L/SC:H/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X`.

### Recommendations

*   **For Developers:** When configuring Windows services, always ensure that the `ImagePath` registry value is properly **quoted**, especially if the installation path contains spaces. For example, use `"C:\Path With Spaces\Service.exe"` instead of `C:\Path With Spaces\Service.exe`.
*   **For Site Owners/Administrators:** Promptly update **ABP** and **AES** installations to versions that address this vulnerability. Regularly monitor security advisories from all software vendors and apply patches as soon as they become available.

### Reference

[https://www.asustor.com/security/security_advisory_detail?id=47](https://www.asustor.com/security/security_advisory_detail?id=47)