## Unrestricted File Upload Vulnerability in code-projects Voting System

Unrestricted file upload vulnerabilities pose a significant threat to web applications, potentially leading to severe consequences such as remote code execution, data compromise, and complete system takeover. This write-up details a critical vulnerability identified in the code-projects Voting System.

### Vulnerability Details

A critical unrestricted file upload vulnerability, identified as **CVE-2025-8174**, has been discovered in **code-projects Voting System version 1.0**.

The flaw resides within the `/admin/candidates_add.php` file, specifically through the manipulation of the `photo` argument. This allows an authenticated attacker to upload arbitrary file types to the server without proper validation or sanitization.

The CVSS 4.0 Base Score for this vulnerability is 5.3 (Medium), though it is classified as critical due to its potential impact. The exploit has been publicly disclosed.

### Technical Cause

The vulnerability stems from inadequate input validation and file handling within the `candidates_add.php` script. When processing the `photo` parameter, the system fails to sufficiently restrict or validate the type, content, or extension of the uploaded file. This allows an attacker to bypass intended security controls and upload malicious scripts, such as web shells, to the server.

### Potential Risks

Exploitation of this unrestricted file upload vulnerability can lead to severe consequences, including:

*   **Remote Code Execution (RCE):** An attacker can upload a web shell (e.g., a PHP script) and then execute arbitrary commands on the server.
*   **Website Defacement:** Malicious content can be uploaded and displayed on the website.
*   **Data Exposure/Manipulation:** An attacker gaining RCE can access, modify, or delete sensitive data on the server or connected databases.
*   **Denial of Service (DoS):** Uploading large or numerous files could exhaust server resources.

### Recommendations

For developers and site owners using **code-projects Voting System 1.0**, immediate action is recommended:

*   **Implement Strict Input Validation:**
    *   **Whitelist File Types:** Only allow specific, known-safe file extensions (e.g., `.jpg`, `.png`, `.gif`). Avoid blacklisting, as it can be easily bypassed.
    *   **Validate File Content:** Perform content-type validation in addition to extension checks.
    *   **Limit File Size:** Enforce strict limits on the maximum file size to prevent resource exhaustion.
*   **Secure File Storage:**
    *   **Outside Web Root:** Store uploaded files in a directory that is not directly accessible via the web server. Files can be served through a script.
    *   **Randomize Filenames:** Rename uploaded files with unique, unpredictable filenames to prevent direct access.
*   **Apply Principle of Least Privilege:**
    *   Ensure the web server user only has the minimum necessary permissions to the upload directory.
*   **Monitor and Update:**
    *   Regularly monitor security advisories for patches or newer, more secure versions of the software. As this is a critical flaw, a patch should be applied as soon as it becomes available.

### Reference

For further information regarding the project, please refer to the project website:

*   [code-projects.org](https://code-projects.org/)