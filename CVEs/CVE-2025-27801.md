## Urgent Security Advisory: Stored XSS Vulnerabilities in Optimizely CMS (Episerver)

A newly identified security vulnerability in **Optimizely CMS (Episerver)** could allow authenticated attackers to execute malicious code within your users' browsers. While requiring a specific user role for exploitation, the potential for data theft, system compromise, or reputation damage makes this a critical concern for organizations leveraging this platform. Proactive patching is strongly advised to protect your digital assets and user trust.

### Vulnerability Details

*   **CVE ID:** **CVE-2025-27801**
*   **Affected Software:** **Episerver Content Management System (CMS)** by **Optimizely**
*   **Affected Versions:**
    *   **Optimizely CMS 11.x:**
        *   **EPiServer.CMS.Core** versions prior to **11.21.4**
        *   **EPiServer.CMS.UI** versions prior to **11.37.5**
    *   **Optimizely CMS 12.x:**
        *   **EPiServer.CMS.Core** versions prior to **12.22.1**
        *   **EPiServer.CMS.UI** versions prior to **11.37.3**
*   **Technical Cause:** This vulnerability is a Stored Cross-Site Scripting (XSS) issue. It arises from insufficient validation when uploading SVG (Scalable Vector Graphics) files through the "ContentReference" properties in the CMS's "Edit" section. An authenticated attacker, specifically with the **WebEditor** role, can upload an SVG file containing malicious JavaScript code. When a user (e.g., an administrator or another legitimate user) visits the direct URL of this uploaded SVG file, the embedded JavaScript is automatically executed in their browser.
*   **Exploitation Example:**
    An attacker could upload an SVG file with content similar to:
    ```html
    <svg onload="alert('XSS Payload Executed!');" xmlns="http://www.w3.org/2000/svg"></svg>
    ```
    Upon a user visiting the direct link to the uploaded SVG, for instance:
    `https://your-cms-domain.com/globalassets/uploaded-images/malicious.svg`
    The JavaScript code (`alert('XSS Payload Executed!');`) would execute in their browser.

### Risk Description

An attacker who successfully exploits this vulnerability can execute arbitrary JavaScript code within the web browser of any user viewing the malicious SVG. This capability poses significant risks, including:

*   **Session Hijacking:** Stealing user session cookies, potentially allowing the attacker to impersonate the victim, including administrators, and gain full control over their CMS session.
*   **Data Theft:** Accessing and exfiltrating sensitive data that the victim can view in their browser, such as customer information, internal documents, or financial records.
*   **Website Defacement/Manipulation:** Altering the appearance or content of the CMS interface within the victim's browser, leading to reputational damage or misinformation.
*   **Malware Distribution:** Redirecting users to malicious websites or tricking them into downloading malware.
*   **Further Attacks:** Leveraging the victim's privileges to launch more sophisticated attacks against the CMS or connected systems.

### Who is at Risk

Organizations and businesses utilizing **Optimizely CMS (Episerver)** are at risk if they are running any of the affected versions listed above. This includes companies managing their websites, e-commerce platforms, or digital experiences through Episerver CMS, especially if "WebEditor" roles are assigned to external parties or if internal accounts with this privilege are compromised.

### Recommendations

**For Website Owners and Administrators:**

*   **Update Immediately:** The most crucial step is to upgrade your **Optimizely CMS (Episerver)** installation to the patched versions as soon as possible.
    *   For **Optimizely CMS 11.x**, ensure **EPiServer.CMS.Core** is updated to **11.21.4** or higher, and **EPiServer.CMS.UI** to **11.37.5** or higher.
    *   For **Optimizely CMS 12.x**, ensure **EPiServer.CMS.Core** is updated to **12.22.1** or higher, and **EPiServer.CMS.UI** to **11.37.3** or higher.
*   **Review User Permissions:** Periodically audit users with **WebEditor** or higher roles. Ensure only trusted and necessary personnel have these elevated privileges.
*   **Monitor Activity:** Implement robust logging and monitoring for unusual activity within the CMS, especially related to file uploads and content modifications.

**For Developers and IT Teams:**

*   **Patching:** Apply the official updates from Optimizely as per the recommendation above. These updates include critical fixes for the XSS vulnerabilities.
*   **Input Validation & Sanitization:** Ensure all user-supplied content, particularly uploaded files like SVGs, undergoes strict validation and sanitization. Do not rely solely on client-side checks. Implement server-side validation to strip out potentially malicious scripts or elements from SVG files.
*   **Content Security Policy (CSP):** Implement or strengthen your Content Security Policy (CSP) headers to limit the sources from which scripts can be loaded and executed, adding another layer of defense against XSS.
*   **Secure File Uploads:** Restrict file uploads to only necessary types and implement secure storage practices. Consider scanning uploaded files for malicious content.

### Reference Link

For more detailed information regarding the patch and release notes, please refer to the official Optimizely advisory:

[Optimizely CMS 11 PaaS release notes](https://support.optimizely.com/hc/en-us/articles/30886353301645-2025-Optimizely-CMS-11-PaaS-release-notes#h_01K09MR1SZS4FEAPD4478GQ0FR)